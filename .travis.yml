language: python

python:
  - "3.6"

services:
  - mongodb

install:
  - pip install pipenv
  - pipenv install --dev --system --deploy

before_script:
  - sleep 10

script:
  - set PYTHONPATH=.
  - flake8
  - python -m pytest

deploy:
  provider: pypi
  user: nedel
  password:
    secure: test_secure
  on:
    tags: true
    distributions: sdist bdist_wheel
    repo: nede1/monypy
    python: '3.6'
